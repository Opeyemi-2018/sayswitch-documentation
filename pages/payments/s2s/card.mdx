## Card Payments (S2S)

### Introduction

Enable secure card transactions by integrating with Sayswitch's Server-to-Server (S2S) API. This approach allows you to handle card payments directly from your backend, keeping sensitive card information off the client side.

### How It Works

1. Safely collect the customer's card information
2. Send the payment request directly to the Sayswitch API
3. Complete 3D Secure (3DS) authentication when prompted
4. Process the API response to determine the payment outcome


### How to Implementation

```javascript copy
const sayswitch = new Sayswitch({
  secretKey: process.env.SAYSWITCH_SECRET_KEY
});

// Process card payment
const cardPayment = await sayswitch.s2s.cards.charge({
  amount: 5000, // Amount in cents
  currency: 'USD',
  card: {
    number: '4242424242424242',
    expiry_month: '12',
    expiry_year: '25',
    cvv: '123'
  },
  customer: {
    email: 'customer@example.com',
    name: 'John Doe'
  },
  reference: 'TX_REF_123'
});
```

### Handling 3D Secure

```javascript
const process3DS = async (paymentId) => {
  const verification = await sayswitch.s2s.cards.verify3DS({
    payment_id: paymentId,
    callback_url: 'https://your-domain.com/3ds-callback'
  });

  return verification.redirect_url;
};
```

### Test Cards

| Card Number | Description | 3DS Status |
|------------|-------------|------------|
| 4242424242424242 | Successful payment | No 3DS |
| 4000000000003220 | Successful payment | 3DS required |
| 4000000000000002 | Declined payment | No 3DS |

### Error Handling

```javascript
try {
  const payment = await sayswitch.s2s.cards.charge({
    // payment details
  });
} catch (error) {
  if (error.code === 'card_declined') {
    // Handle declined card
  } else if (error.code === '3ds_required') {
    // Redirect to 3DS verification
  } else {
    // Handle other errors
  }
}
```

### Security Requirements

1. **PCI Compliance**
   - Maintain compliance with PCI DSS standards when handling card information  
   - Ensure all connections use TLS version 1.2 or higher  
   - Apply strong encryption practices to protect sensitive data  

2. **Data Validation**
   - Use the Luhn algorithm to validate card numbers  
   - Confirm that card expiry dates are valid and current  
   - Verify that the CVV is in the correct format before processing  


### Response Codes

| Code | Description |
|------|-------------|
| 0000 | Success |
| 1000 | Card declined |
| 1001 | Insufficient funds |
| 1002 | Card expired |
| 1003 | Invalid card |

### Best Practices

- Never log full card numbers
- Implement retry logic for failed transactions
- Store card tokens for recurring payments
- Monitor fraud patterns
- Implement velocity checks



Need help? Contact our support team at support@sayswitch.com